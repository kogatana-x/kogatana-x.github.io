<!DOCTYPE html>
<html lang="en">
<head>
    <title>kogatana-x</title>
    <meta name="description" content="Offensive//Defensive Security Content Search Page">
    <meta http-equiv='content-language' content='en-us'> 
    <meta name="author" content="kogatana-x">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="kogatana-x, offensive security, defensive security, sysadmin, programming">
    <link rel="canonical" href="https://kogatana-x.github.io/categories.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="kogatana-x.css">
</head>
<body>

    <div class="navbar">
        <a href="https://kogatana-x.github.io/">
            <img src="images/22989723.png" alt="Profile"> 
        </a>
        <h2>kogatana-x</h2>
        <p>Offensive//Defensive Security</p>
        <div class="social">
            <a href="https://github.com/kogatana-x" target="_blank" rel="noreferrer noopener">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ee4c4f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
                    <title>My Github</title>
                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                </svg>
            </a>
            <a href="https://www.linkedin.com/in/anna-andler" target="_blank" rel="noreferrer noopener">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ee4c4f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
                    <title>My linkedin</title>
                    <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
                </svg>
            </a>
        </div>
    </div>

    <div class="content">
        <a href="https://kogatana-x.github.io/" style="text-decoration: none;">
            <div class="banner">
                <pre>

    ██╗  ██╗ ██████╗  ██████╗  █████╗ ████████╗ █████╗ ███╗   ██╗ █████╗      ██╗  ██╗
    ██║ ██╔╝██╔═══██╗██╔════╝ ██╔══██╗╚══██╔══╝██╔══██╗████╗  ██║██╔══██╗     ╚██╗██╔╝
    █████╔╝ ██║   ██║██║  ███╗███████║   ██║   ███████║██╔██╗ ██║███████║█████╗╚███╔╝ 
    ██╔═██╗ ██║   ██║██║   ██║██╔══██║   ██║   ██╔══██║██║╚██╗██║██╔══██║╚════╝██╔██╗ 
    ██║  ██╗╚██████╔╝╚██████╔╝██║  ██║   ██║   ██║  ██║██║ ╚████║██║  ██║     ██╔╝ ██╗
    ╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝     ╚═╝  ╚═╝                                                                                 

    ──────────────────────────────────────────────────────────────────────────────────
                </pre>
            </div>   
        </a>
    <div class="page">
        <h2 style="padding:10px;">Relevant Posts Results</h2>
    </div> 
    <div id="blogContainer"></div>
    <h2 style="padding:10px;">Categories</h2>
    <div id="categoryContainer">
        <table>
            <tbody>
                <tr>
                    
                </tr>
            </tbody>
        </table>
    </div>
    <div class="footer">
        <p>© 2021 kogatana-x</p>
    </div>
</body>

</html>

<script>
// Fetch all posts
fetch('https://kogatana-x.github.io/posts/posts.json')
    .then(response => response.json())
    .then(postUrls => {
        // Fetch the HTML of each post and keep the association with its URL
        return Promise.all(postUrls.map(url => 
            fetch(url)
            .then(response => response.text())
            .then(html => ({html, url})) // Return an object with both the HTML and the URL
        ));
    })
    .then(posts => {
        // Get the category from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const category = urlParams.get('category');

        // Filter the posts by category
        const parser = new DOMParser();
        filteredPosts = posts.filter(post => {
            const doc = parser.parseFromString(post.html, 'text/html');
            const metaCategory = doc.querySelector('meta[name="category"]').getAttribute('content');
            return metaCategory === category;
        });
        if (category === '*'){
            filteredPosts = posts;
        } 
        if(category.length === 0 || filteredPosts.length === 0){
                    const noposts = document.createElement('h3');
                    noposts.textContent = 'Nice try, please select a valid category.';
                    noposts.style.color = '#ee4c4f';
                    noposts.style.margin = '1em';
                    blogContainer.appendChild(noposts);
        } else {
        
        // Create a post element for each post in the filtered list
        const blogContainer = document.querySelector('#blogContainer');
        filteredPosts.forEach(post => {
            const doc = parser.parseFromString(post.html, 'text/html');
            const postElement = document.createElement('div');
            const title = doc.querySelector('title').textContent;
            const time = doc.querySelector('time').textContent;
            const description = doc.querySelector('meta[name="description"]').content;
            
            postElement.classList.add('blog-post');
            
            const titleElement = document.createElement('h3');
            const linkElement = document.createElement('a');
            linkElement.href = post.url; // Set the href to the post URL
            linkElement.textContent = title;
            linkElement.style.color = 'inherit'; // Inherit the color from the h2
            linkElement.style.textDecoration = 'none'; // Remove the underline
            
            titleElement.appendChild(linkElement); // Append the link to the h2

            postElement.appendChild(titleElement);

            const timeElement = document.createElement('span');
            const strongElement = document.createElement('strong'); // Create a strong tag to bold the time
            strongElement.textContent = time; // Use the time variable
            timeElement.appendChild(strongElement);
            postElement.appendChild(timeElement);

            const descriptionElement = document.createElement('span');
            descriptionElement.textContent = ' - ' + description; // Use the description variable
            postElement.appendChild(descriptionElement);

            blogContainer.appendChild(postElement);
        });
    }
    })
    .catch(error => console.error(error));


    $(document).ready(function() {
        // Initialize categories as an empty array
        var categories = [];
        const categoryImages = {
            'offensive': 'https://kogatana-x.github.io/images/Categories/offensive.jpg',
            'defensive': 'https://kogatana-x.github.io/images/Categories/defensive.jpg',
            'sysadmin': 'https://kogatana-x.github.io/images/Categories/sysadmin.jpg',
            'programming': 'https://kogatana-x.github.io/images/Categories/programming.jpg',
            '*': 'https://kogatana-x.github.io/images/Categories/everything.jpg'
        };

        // Fetch all posts and add them to the page
        fetch('https://kogatana-x.github.io/posts/posts.json')
            .then(response => response.json())
            .then(postUrls => {
                // Fetch the HTML of each post
                return Promise.all(postUrls.map(url => fetch(url).then(response => response.text())))
                    .then(postsHtml => [postUrls, postsHtml]);
            })
            .then(([postUrls, postsHtml]) => {
                const parser = new DOMParser();
                postsHtml.forEach((html, index) => {
                    // Parse the HTML
                    const doc = parser.parseFromString(html, 'text/html');

                    // Fetch the category from the post's meta tag
                    const category = doc.querySelector('meta[name="category"]').getAttribute('content');

                    // Add the category to the categories array if it's not already in it
                    if (categories.indexOf(category) === -1) {
                        categories.push(category);
                    }
                });
                categories.push('*'); // Add a wildcard category

                // Create a category box for each unique category
                categories.forEach(category => {
                    var categoryBox = document.createElement('div');
                    categoryBox.className = 'categoryBox';
                    categoryBox.textContent = category;

                    var categoryImage = categoryImages[category]; // Get the image URL
                    categoryBox.style.backgroundImage = `url(${categoryImage})`; // Set the background image

                    document.querySelector('#categoryContainer').appendChild(categoryBox);
                });

                // When a category box is clicked, navigate to a new page that displays posts with the same category
                document.querySelectorAll('.categoryBox').forEach(box => {
                    box.addEventListener('click', function() {
                        var category = this.textContent;
                        window.location.href = 'categories.html?category=' + encodeURIComponent(category);
                    });
                });
            })
        .catch(error => console.error(error));
    }); 
</script>